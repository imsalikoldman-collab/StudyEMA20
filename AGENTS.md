# AGENTS.md — инструкция для код-агентов

## О проекте
- Репозиторий содержит пользовательское исследование **StudyEMA20** для Sierra Chart: строит EMA 20/9 и отображает контрольный счётчик.
- Основной исходный код: `src/EMA20Study.cpp`. Файлы решения: `StudyEMA20.sln`, `StudyEMA20.vcxproj`.
- Служебные примеры ACSIL находятся в `examples/` и используются как эталон оформления и API‑паттернов.

## Команды и сценарии
- `pwsh .\scripts\build.ps1` — сборка (Release по умолчанию). Параметры `-Configuration Debug`, `-Clean`.
- `pwsh .\scripts\verify.ps1` — чистая сборка + проверка корректности расчётов EMA.
- `pwsh .\scripts\deploy.ps1` — копирование DLL в рабочий каталог Sierra Chart, отправляет `RELEASE_DLL`.
- `pwsh .\scripts\hotdeploy.ps1` — горячая замена DLL с атомарным копированием и командами `RELEASE_DLL/ALLOW_LOAD_DLL`.
- `pwsh .\scripts\release.ps1` — последовательность «сборка → хот‑деплой» (флаги `-SkipBuild`, `-SkipHotDeploy`).
- Все скрипты ожидают PowerShell 7+, установленный MSVC v143 x64 и заголовки ACSIL по пути `C:\2308\ACS_Source\`.

## Стандарты и ограничения
- Поддерживайте совместимость с Sierra Chart 2308+. Не меняйте путь к заголовкам ACSIL без синхронизации с `StudyEMA20.vcxproj`.
- Не добавляйте сторонние зависимости и не модифицируйте содержимое `build/` вручную — каталог пересоздаётся сборкой.
- Соблюдайте текущий стиль C++: используйте существующие хелперы, поддерживайте форматирование и нейминги, не внедряйте нестабильные глобальные состояния.
- Перед созданием PR обязательно запускайте `build.ps1` и `verify.ps1`. После правок в DLL‑логике проверяйте `deploy.ps1` или `hotdeploy.ps1` (без обязанности коммитить артефакты).

## Документация в `docs/`
- `docs/README.md` — короткое описание StudyEMA20, структура репозитория и быстрый старт.
- `docs/PROJECT_GUIDE.md` — расширенное руководство по окружению, сборке, деплою и устранению неполадок.
- `docs/EXAMPLES_USAGE.md` — глоссарий по файлам из `examples/`, поясняет, когда использовать конкретный эталон.
- `docs/справка_по_AGENTS.md` — методичка по наполнению `AGENTS.md` и ожиданиям к файлу для агентов; сверяйтесь при обновлениях.

## Чего избегать
- Не коммить артефакты сборки, временные файлы Visual Studio и персональные конфиги Sierra Chart.
- Не удаляйте и не переименовывайте готовые скрипты в `scripts/` без согласования — автоматизация CI и хот‑деплоя на них завязана.
- Не размещайте секреты или путевые настройки вне `.ps1`‑параметров — используйте аргументы скриптов.

## Чек‑лист перед PR
- [ ] Сборка проходит: `pwsh .\scripts\build.ps1 [-Configuration Debug]`.
- [ ] Проверки успешны: `pwsh .\scripts\verify.ps1`.
- [ ] Обновлена документация, если менялись скрипты, шаги развертывания или структура.
- [ ] Изменения в `AGENTS.md` согласованы с рекомендациями из `docs/справка_по_AGENTS.md`.

> Подсказка: при работе через Codex/GPT указывайте этот файл в контексте — он содержит минимальный набор правил и ссылок, необходимых агентам.
